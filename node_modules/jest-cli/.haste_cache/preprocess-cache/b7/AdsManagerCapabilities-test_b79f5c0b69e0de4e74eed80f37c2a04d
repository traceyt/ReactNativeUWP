'use strict';






jest.dontMock('AdsManagerCapabilities').
dontMock('AdsAPIObjectives').
dontMock('immutable');








var UNSUPPORTED_OBJECTIVE=require('AdsAPIObjectives').MOBILE_APP_INSTALLS;
var STORY_TYPE='Story';
var PAGE_TYPE='Page';
var UNSUPPORTED_PROMOTED_OBJECT_TYPE='Event';


var CAMPAIGN_GROUP_base=require('immutable').fromJS({
id:'wild id 3',
objective:require('AdsAPIObjectives').PAGE_LIKES});



var TRAGET_SPEC_base=require('immutable').fromJS({
client_can_edit:true,
geo_locations:{
edges:[
{
node:{
location_type:'haha'}}],



page_info:{
has_next_page:true}}});




var DEFAULT_VOICE_PAGE_base=require('immutable').fromJS({
node_id:'wild id 4',
node:{
id:'wild id 5',
name:'haha'}});



var CAMPAIGN_base=require('immutable').fromJS({
id:'wild id 2',
client_can_edit:true,
ad_campaign_group:CAMPAIGN_GROUP_base,
target_spec:TRAGET_SPEC_base,
default_voice_page:DEFAULT_VOICE_PAGE_base});



var PROMOTED_OBJECT_base=require('immutable').fromJS({
node_id:'wild id 6',
node:{
__type__:{
name:PAGE_TYPE}}});




var OBJECT_SOTRY_SPEC_base=require('immutable').fromJS({
link_data:{
name:'haha',
message:'haha',
link:'haha',
image_hash:'haha'}});



var CREATIVE_base=require('immutable').fromJS({
promoted_object:PROMOTED_OBJECT_base,
object_story_spec:OBJECT_SOTRY_SPEC_base,
body_text:'haha',
image_hash:'haha'});


var ADGROUP_base=require('immutable').fromJS({
id:'wild id 1',
client_can_edit:true,
ad_campaign:CAMPAIGN_base,
creative:CREATIVE_base,
client_can_create_similar:true,
create_similar_raw_spec:'haha'});


describe('AdsManagerCapabilities',function(){
it('get if an objective is supported or not correctly ',function(){
expect(
require('AdsManagerCapabilities').isCreateSimilarSupportedObjective()).
toBe(false);
expect(require('AdsManagerCapabilities').isCreateSimilarSupportedObjective(
require('AdsAPIObjectives').PAGE_LIKES)).
toBe(true);
expect(require('AdsManagerCapabilities').isCreateSimilarSupportedObjective(
UNSUPPORTED_OBJECTIVE)).
toBe(false);});


it('get if a promoted object is supported or not correctly',function(){
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').POST_ENGAGEMENT)).
toBe(false);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').POST_ENGAGEMENT,
UNSUPPORTED_PROMOTED_OBJECT_TYPE)).
toBe(false);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').POST_ENGAGEMENT,
STORY_TYPE)).
toBe(true);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').WEBSITE_CLICKS)).
toBe(true);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').WEBSITE_CLICKS,
STORY_TYPE)).
toBe(true);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').LOCAL_AWARENESS)).
toBe(true);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').LOCAL_AWARENESS,
PAGE_TYPE)).
toBe(true);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').PAGE_LIKES)).
toBe(false);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').PAGE_LIKES,
UNSUPPORTED_PROMOTED_OBJECT_TYPE)).
toBe(false);
expect(require('AdsManagerCapabilities').isPromotedObjectSupoorted(
require('AdsAPIObjectives').PAGE_LIKES,
PAGE_TYPE)).
toBe(true);
expect(function(){return require('AdsManagerCapabilities').isPromotedObjectSupoorted(
UNSUPPORTED_OBJECTIVE);}).
toThrow();});


it('get if a targeting spec is supported or not correctly',function(){
expect(require('AdsManagerCapabilities').isSupportedTargetingSpecType({})).toBe(false);
expect(require('AdsManagerCapabilities').isSupportedTargetingSpecType(
CAMPAIGN_base.toJS())).
toBe(true);});


it('get if apps can create similar ads or not correctly',function(){
expect(require('AdsManagerCapabilities').canCreateSimilar()).toBe(false);
expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_base.toJS())).
toBe(true);


var ADGROUP_1=ADGROUP_base.setIn(
['ad_campaign','ad_campaign_group','objective'],
UNSUPPORTED_OBJECTIVE);

expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_1.toJS())).
toBe(false);


var ADGROUP_2=ADGROUP_base.deleteIn(['creative','promoted_object']);
expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_2.toJS())).
toBe(false);


var ADGROUP_3=ADGROUP_base.setIn(
['creative','promoted_object','node','__type__','name'],
UNSUPPORTED_PROMOTED_OBJECT_TYPE);

expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_3.toJS())).
toBe(false);


var ADGROUP_4=ADGROUP_base.setIn(
['client_can_create_similar'],
false);

expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_4.toJS())).
toBe(false);


var ADGROUP_5=ADGROUP_base.deleteIn(['create_similar_raw_spec']);
expect(
require('AdsManagerCapabilities').canCreateSimilar(ADGROUP_5.toJS())).
toBe(false);});


it('get if apps can get default page correctly',function(){
expect(require('AdsManagerCapabilities').canGetDefaultPage()).toBe(false);
expect(
require('AdsManagerCapabilities').canGetDefaultPage(CAMPAIGN_base.toJS())).
toBe(true);


var CAMPAIGN_1=CAMPAIGN_base.deleteIn(['default_voice_page']);
expect(
require('AdsManagerCapabilities').canGetDefaultPage(CAMPAIGN_1.toJS())).
toBe(false);


var CAMPAIGN_2=CAMPAIGN_base.deleteIn(
['default_voice_page','node']);

expect(
require('AdsManagerCapabilities').canGetDefaultPage(CAMPAIGN_2.toJS())).
toBe(false);


var CAMPAIGN_3=CAMPAIGN_base.deleteIn(
['default_voice_page','node_id']);

expect(
require('AdsManagerCapabilities').canGetDefaultPage(CAMPAIGN_3.toJS())).
toBe(false);});


it('get if apps can edit image or not correctly',function(){
expect(require('AdsManagerCapabilities').canEditImage()).toBe(false);
expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_base.toJS())).toBe(true);


var ADGROUP_1=ADGROUP_base.setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').POST_ENGAGEMENT);

expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_1.toJS())).toBe(false);


var ADGROUP_2=ADGROUP_base.setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CONVERSIONS);

expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_2.toJS())).toBe(true);


var ADGROUP_3=ADGROUP_base.deleteIn(['creative']);
expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_3.toJS())).toBe(false);



var ADGROUP_4=ADGROUP_base.deleteIn(
['creative','body_text']);

expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_4.toJS())).toBe(false);



var ADGROUP_5=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec']);
expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_5.toJS())).toBe(false);



var ADGROUP_6=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec','link_data']);
expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_6.toJS())).toBe(false);



var ADGROUP_7=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec','link_data','image_hash']);
expect(require('AdsManagerCapabilities').canEditImage(ADGROUP_7.toJS())).toBe(false);});


it('get if apps can edit creative or not correctly',function(){
expect(require('AdsManagerCapabilities').canEditCreative()).toBe(false);
expect(
require('AdsManagerCapabilities').canEditCreative(ADGROUP_base.toJS())).
toBe(true);


var ADGROUP_1=ADGROUP_base.setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').POST_ENGAGEMENT);

expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_1.toJS())).toBe(false);


var ADGROUP_3=ADGROUP_base.setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CONVERSIONS);

expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_3.toJS())).toBe(true);



var ADGROUP_4=ADGROUP_base.deleteIn(
['creative','image_hash']);

expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_4.toJS())).toBe(false);



var ADGROUP_5=ADGROUP_base.deleteIn(
['creative','promoted_object']);

expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_5.toJS())).toBe(false);



var ADGROUP_6=ADGROUP_base.deleteIn(
['creative','promoted_object','node_id']);

expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_6.toJS())).toBe(false);



var ADGROUP_7=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec']);
expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_7.toJS())).toBe(false);



var ADGROUP_8=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec','link_data']);
expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_8.toJS())).toBe(false);



var ADGROUP_9=ADGROUP_base.
setIn(
['ad_campaign','ad_campaign_group','objective'],
require('AdsAPIObjectives').WEBSITE_CLICKS).

deleteIn(['creative','object_story_spec','link_data','message']);
expect(require('AdsManagerCapabilities').canEditCreative(ADGROUP_9.toJS())).toBe(false);});


it('get if apps can edit audience or not correctly',function(){
expect(
require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_base.toJS())).
toBe(true);


var CAMPAIGN_1=CAMPAIGN_base.setIn(
['ad_campaign_group','objective'],
require('AdsAPIObjectives').BRAND_AWARENESS);

expect(require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_1.toJS())).toBe(false);


var CAMPAIGN_2=CAMPAIGN_base.deleteIn(['target_spec','geo_locations']);
expect(require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_2.toJS())).toBe(false);



var CAMPAIGN_3=CAMPAIGN_base.setIn(
['target_spec','client_can_edit'],
false);

expect(require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_3.toJS())).toBe(false);



var CAMPAIGN_4=CAMPAIGN_base.setIn(
['ad_campaign_group','objective'],
require('AdsAPIObjectives').LOCAL_AWARENESS);

expect(require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_4.toJS())).toBe(false);



var CAMPAIGN_5=CAMPAIGN_base.
setIn(
['ad_campaign_group','objective'],
require('AdsAPIObjectives').LOCAL_AWARENESS).
setIn(
['target_spec','geo_locations','edges','0','node','location_type'],
require('AdsManagerLocations').CUSTOM_LOCATION);

expect(require('AdsManagerCapabilities').canEditAudience(CAMPAIGN_5.toJS())).toBe(true);});


it('get if apps can edit an object or not correctly',function(){
var ADOBJECT_base={
client_can_edit:true};

var ADOBJECT_1={
client_can_edit:false};


expect(require('AdsManagerCapabilities').canClientEditObject()).toBe(false);
expect(require('AdsManagerCapabilities').canClientEditObject({})).toBe(false);
expect(require('AdsManagerCapabilities').canClientEditObject(ADOBJECT_base)).toBe(true);
expect(require('AdsManagerCapabilities').canClientEditObject(ADOBJECT_1)).toBe(false);});});