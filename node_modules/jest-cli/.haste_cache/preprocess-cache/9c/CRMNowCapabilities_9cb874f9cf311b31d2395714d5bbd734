'use strict';
















































var Queries={
getCanCreateSimilarQuery:function(){
return function(RQL_0){return {children:[{children:[{children:[{fieldName:'objective',kind:'Field',metadata:{},type:'AdObjectiveType'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'ad_campaign_group',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCampaignGroup'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'ad_campaign',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCampaign'},{children:[{children:[].concat.apply([],[require('Relay').QL.__frag(RQL_0)]),fieldName:'promoted_object',kind:'Field',metadata:{canHaveSubselections:true},type:'NodeWrapper'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'creative',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCreative'},{fieldName:'client_can_create_similar',kind:'Field',metadata:{},type:'Boolean'},{fieldName:'create_similar_raw_spec',kind:'Field',metadata:{},type:'String'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetCanCreateSimilarQueryRelayQL',type:'Adgroup'};}(








Queries.getPromotedObjectFragment());},








getAdCampaignGroupCapabilityQuery:function(){
return function(){return {children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{fieldName:'objective',kind:'Field',metadata:{},type:'AdObjectiveType'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetAdCampaignGroupCapabilityQueryRelayQL',type:'AdCampaignGroup'};}();},










getAdCampaignCapabilityQuery:function(){
return function(RQL_0,RQL_1){return {children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{fieldName:'client_can_edit',kind:'Field',metadata:{},type:'Boolean'},{children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},require('Relay').QL.__frag(RQL_0)]),fieldName:'ad_campaign_group',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCampaignGroup'},{children:[].concat.apply([],[require('Relay').QL.__frag(RQL_1)]),fieldName:'target_spec',kind:'Field',metadata:{canHaveSubselections:true},type:'AdTargetSpecification'},{children:[{fieldName:'node_id',kind:'Field',metadata:{},type:'ID'},{children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{directives:[{kind:'Directive',name:'fixme_fat_interface',args:[]}],fieldName:'name',kind:'Field',metadata:{},type:'String'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],fieldName:'node',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true},type:'Node'}],fieldName:'default_voice_page',kind:'Field',metadata:{canHaveSubselections:true},type:'NodeWrapper'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetAdCampaignCapabilityQueryRelayQL',type:'AdCampaign'};}(




Queries.getAdCampaignGroupCapabilityQuery(),


Queries.getTargetSpecFragment());},















getAdgroupCapabilityQuery:function(){
return function(RQL_0,RQL_1){return {children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{fieldName:'client_can_edit',kind:'Field',metadata:{},type:'Boolean'},{children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},require('Relay').QL.__frag(RQL_0)]),fieldName:'ad_campaign',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCampaign'},{children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},require('Relay').QL.__frag(RQL_1)]),fieldName:'creative',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'AdCreative'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetAdgroupCapabilityQueryRelayQL',type:'Adgroup'};}(




Queries.getAdCampaignCapabilityQuery(),


Queries.getCreativeFragment());},





getTargetSpecFragment:function(){
return function(){return {children:[{fieldName:'client_can_edit',kind:'Field',metadata:{},type:'Boolean'},{calls:[{kind:'Call',metadata:{},name:'first',value:{kind:'CallValue',callValue:1}}],children:[{children:[{children:[{fieldName:'location_type',kind:'Field',metadata:{},type:'AdGeoLocationType'}],fieldName:'node',kind:'Field',metadata:{canHaveSubselections:true,isRequisite:true},type:'AdGeoLocation'},{fieldName:'cursor',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'edges',kind:'Field',metadata:{canHaveSubselections:true,isPlural:true},type:'AdTargetSpecificationGeoLocationsEdge'},{children:[{fieldName:'has_next_page',kind:'Field',metadata:{isRequisite:true},type:'Boolean'},{fieldName:'has_previous_page',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'Boolean'}],fieldName:'page_info',kind:'Field',metadata:{canHaveSubselections:true,isRequisite:true},type:'PageInfo'}],fieldName:'geo_locations',kind:'Field',metadata:{canHaveSubselections:true,isConnection:true},type:'AdTargetSpecificationGeoLocationsConnection'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetTargetSpecFragmentRelayQL',type:'AdTargetSpecification'};}();},
















getCreativeFragment:function(){
return function(RQL_0){return {children:[{fieldName:'client_can_edit',kind:'Field',metadata:{},type:'Boolean'},{fieldName:'body_text',kind:'Field',metadata:{},type:'String'},{fieldName:'image_hash',kind:'Field',metadata:{},type:'String'},{children:[].concat.apply([],[require('Relay').QL.__frag(RQL_0)]),fieldName:'promoted_object',kind:'Field',metadata:{canHaveSubselections:true},type:'NodeWrapper'},{children:[{children:[{fieldName:'name',kind:'Field',metadata:{},type:'String'},{fieldName:'message',kind:'Field',metadata:{},type:'String'},{fieldName:'link',kind:'Field',metadata:{},type:'String'},{fieldName:'image_hash',kind:'Field',metadata:{},type:'String'}],fieldName:'link_data',kind:'Field',metadata:{canHaveSubselections:true},type:'AdObjectStoryLinkDataSpecification'}],fieldName:'object_story_spec',kind:'Field',metadata:{canHaveSubselections:true},type:'AdObjectStorySpecification'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetCreativeFragmentRelayQL',type:'AdCreative'};}(





Queries.getPromotedObjectFragment());},













getPromotedObjectFragment:function(){
return function(){return {children:[{fieldName:'node_id',kind:'Field',metadata:{},type:'ID'},{children:[{children:[{fieldName:'name',kind:'Field',metadata:{},type:'String'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},{children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}],fieldName:'__type__',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true},type:'Type'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],fieldName:'node',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true},type:'Node'}],id:require('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'CRMNowCapabilities_GetPromotedObjectFragmentRelayQL',type:'NodeWrapper'};}();}};












var CRMNowCapabilities={
Queries:Queries,

canCreateSimilar:function(adgroup){
if(!adgroup){
return false;}


var objective=adgroup.ad_campaign.ad_campaign_group.objective;
var type=this._getPromotedObjectTypeFromAdgroup(adgroup);
return (
this.isCreateSimilarSupportedObjective(objective)&&
this.isPromotedObjectSupoorted(objective,type)&&
adgroup.client_can_create_similar&&
!!adgroup.create_similar_raw_spec);},



canGetDefaultPage:function(campaign){




var page=campaign&&campaign.default_voice_page;
return !!(page&&page.node_id&&page.node);},


canEditImage:function(adgroup){
if(!this._canEditAdgroupCreative(adgroup)){
return false;}

if(adgroup.ad_campaign.ad_campaign_group.objective===
require('CRMAPIObjectives').PAGE_LIKES){
return !!(
this._getPromotedObjectTypeFromAdgroup(adgroup)==='Page'&&
adgroup.creative.body_text);}


return !!(
adgroup.creative.object_story_spec&&
adgroup.creative.object_story_spec.link_data&&
adgroup.creative.object_story_spec.link_data.image_hash&&
adgroup.creative.object_story_spec.link_data.link);},



canEditCreative:function(adgroup){
if(!this._canEditAdgroupCreative(adgroup)){
return false;}

if(adgroup.ad_campaign.ad_campaign_group.objective===
require('CRMAPIObjectives').PAGE_LIKES){
return !!(
adgroup.creative.promoted_object&&
adgroup.creative.promoted_object.node_id&&
adgroup.creative.body_text&&
adgroup.creative.image_hash);}


return !!(
adgroup.creative.object_story_spec&&
adgroup.creative.object_story_spec.link_data&&
adgroup.creative.object_story_spec.link_data.name&&
adgroup.creative.object_story_spec.link_data.message&&
adgroup.creative.object_story_spec.link_data.link);},



canEditAudience:function(campaign){

if(this.getObjectiveFromCampaign(campaign)===
require('CRMAPIObjectives').BRAND_AWARENESS){
return false;}


var locations=campaign.target_spec&&campaign.target_spec.geo_locations;
if(!(locations&&
this.canGetDefaultPage(campaign)&&
this.canClientEditObject(campaign.target_spec))){
return false;}



if(this.getObjectiveFromCampaign(campaign)===
require('CRMAPIObjectives').LOCAL_AWARENESS){
if(locations.edges.length===0||
locations.has_next_page||
locations.edges[0].node.location_type!==
require('CRMNowLocations').CUSTOM_LOCATION){
return false;}}



return true;},


canClientEditObject:function(adObject){
return !!(
adObject&&
adObject.client_can_edit);},



isCreateSimilarSupportedObjective:function(
objective)
{
switch(objective){
case require('CRMAPIObjectives').POST_ENGAGEMENT:
case require('CRMAPIObjectives').WEBSITE_CLICKS:
case require('CRMAPIObjectives').LOCAL_AWARENESS:
case require('CRMAPIObjectives').PAGE_LIKES:
return true;
default:
return false;}},





isPromotedObjectSupoorted:function(
objective,
promotedObjectType)
{
switch(objective){
case require('CRMAPIObjectives').POST_ENGAGEMENT:
return promotedObjectType==='Story';
case require('CRMAPIObjectives').WEBSITE_CLICKS:
case require('CRMAPIObjectives').LOCAL_AWARENESS:
return true;
case require('CRMAPIObjectives').PAGE_LIKES:
return promotedObjectType==='Page';
default:
!false?require('invariant')(0,'invalid objective type %s',objective):undefined;}},



isSupportedTargetingSpecType:function(campaign){

return !!campaign.target_spec;},


getObjectiveFromCampaign:function(
campaign)
{
return campaign.ad_campaign_group.objective;},


_canEditAdgroupCreative:function(adgroup){
if(!adgroup||
!adgroup.ad_campaign||
!adgroup.ad_campaign.ad_campaign_group){
return false;}

var objective=adgroup.ad_campaign.ad_campaign_group.objective;
return !!(
this._isEditCreativeSupportedObjective(objective)&&
this.canGetDefaultPage(adgroup.ad_campaign)&&
adgroup.creative);},



_getPromotedObjectTypeFromAdgroup:function(
adgroup)
{
return (
adgroup&&
adgroup.creative&&
adgroup.creative.promoted_object&&
adgroup.creative.promoted_object.node_id&&
adgroup.creative.promoted_object.node&&
adgroup.creative.promoted_object.node.__type__&&
adgroup.creative.promoted_object.node.__type__.name);},



_isEditCreativeSupportedObjective:function(
objective)
{
switch(objective){
case require('CRMAPIObjectives').WEBSITE_CLICKS:
case require('CRMAPIObjectives').WEBSITE_CONVERSIONS:
case require('CRMAPIObjectives').LOCAL_AWARENESS:
case require('CRMAPIObjectives').PAGE_LIKES:
return true;
default:
return false;}}};




module.exports=CRMNowCapabilities;